<div id="demo-container" class="container-slickgrid col-md-12 content">
  <div class="phan-tich-san-pham-header">
    <h2 id="page-heading">{{ title }}</h2>
    <!-- <div class="btn-header">
      <button class="btn btn-outline-dark btn-option btn-addTN me-2 btn-menu" (click)="openGridMenu($event)">
        <i class="fa fa-filter"></i>
      </button>
    </div> -->
  </div>
  <angular-slickgrid
    gridId="phan-tich-san-pham"
    [columnDefinitions]="columnDefinitions1"
    [gridOptions]="gridOptions1"
    [dataset]="donBaoHanhs"
    (onAngularGridCreated)="angularGridReady($event)"
  >
  </angular-slickgrid>
</div>

<div class="alert" id="no-result" *ngIf="donBaoHanhs?.length === 0">
  <div class="loader">
    <div class="justify-content-center jimu-primary-loading"></div>
  </div>
</div>
<!---------------------------------------------------------- popup chi tiết sản phẩm phân tích --------------------------------------------------->
<div class="table-responsive popup-background full-overlay" role="dialog" *ngIf="popupPTMTN === true">
  <div class="popup-container full-container">
    <div class="popup-header">
      <h2>Thông tin mã tiếp nhận</h2>
      <hr />
      <span class="close-btn" (click)="closePopupPTMTN()">&times;</span>
    </div>
    <div class="popup-content full-body">
      <form>
        <div class="fixed-header-table">
          <table class="table table-striped" aria-describedby="page-heading">
            <thead style="background-color: #006699">
              <tr jhiSort [(predicate)]="predicate" [(ascending)]="ascending">
                <th scope="col" jhiSortBy="id" style="width: 3rem">
                  <span class="span-table-phantich">Mã tiếp nhận</span>
                </th>
                <th scope="col" jhiSortBy="id" style="width: 20rem">
                  <span class="span-table-phantich">Khách hàng</span>
                </th>
                <th scope="col" jhiSortBy="id" style="width: 5rem">
                  <span class="span-table-phantich">Số lượng phân tích</span>
                </th>
                <th scope="col" jhiSortBy="id" style="width: 5rem">
                  <span class="span-table-phantich">Đã phân tích</span>
                </th>
                <th scope="col" jhiSortBy="id" style="width: 3rem">
                  <span class="span-table-phantich">Tiến độ</span>
                </th>
                <th scope="col" jhiSortBy="id" style="width: 7rem">
                  <span class="span-table-phantich">Ngày tiếp nhận</span>
                </th>
                <th scope="col" jhiSortBy="id" style="width: 8rem">
                  <span class="span-table-phantich">Trạng thái</span>
                </th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>
                  <!-- <input
                    type="text"
                    class="inp-ptich-sp"
                    style="background-color: #f2f2f2; width: 9rem; border: none"
                    value="{{ donBaoHanh.maTiepNhan }}"
                    disabled
                  /> -->
                  {{ donBaoHanh.maTiepNhan }}
                </td>
                <td>
                  <!-- <input
                    type="text"
                    class="inp-ptich-sp"
                    style="background-color: #f2f2f2; width: 20rem; border: none"
                    value="{{ donBaoHanh.khachHang?.tenKhachHang }}"
                    disabled
                  /> -->
                  {{ donBaoHanh.khachHang?.tenKhachHang }}
                </td>
                <td>
                  <!-- <input
                    type="text"
                    class="inp-ptich-sp"
                    style="background-color: #f2f2f2; border: none"
                    value="{{ donBaoHanh.slCanPhanTich }}"
                    disabled
                  /> -->
                  {{ donBaoHanh.slCanPhanTich }}
                </td>
                <td>
                  <!-- <input
                    type="text"
                    class="inp-ptich-sp"
                    style="background-color: #f2f2f2; border: none"
                    value="{{ donBaoHanh.slDaPhanTich }}"
                    disabled
                  /> -->
                  {{ donBaoHanh.slDaPhanTich }}
                </td>
                <td>
                  <input
                    type="range"
                    class="inp-ptich-sp"
                    style="background-color: #f2f2f2; border: none"
                    value="{{ donBaoHanh.tienDo.toFixed(2) }}"
                    id="donBaoHanh"
                  />{{ donBaoHanh.tienDo.toFixed(2) }}%
                </td>
                <td>{{ donBaoHanh.ngayTiepNhan | date: 'YYYY-MM-dd hh:mm:ss ' }}</td>
                <td>
                  <input
                    type="text"
                    class="inp-ptich-sp"
                    [ngStyle]="getStyle(donBaoHanh.trangThai)"
                    [(ngModel)]="donBaoHanh.trangThai"
                    [ngModelOptions]="{ standalone: true }"
                    disabled
                  />
                </td>
              </tr>
            </tbody>
          </table>
        </div>
      </form>
      <!-- <br />
      <br /> -->
      <form>
        <div class="info-card">
          <h2>Thông tin sản phẩm mã tiếp nhận</h2>
          <div class="fixed-header-table">
            <div class="table-toolbar">
              <div class="search-group">
                <label for="searchKey">Tìm kiếm sản phẩm:</label>
                <input
                  type="text"
                  placeholder="Tìm kiếm"
                  class="form-control"
                  list="PTSP_ten_san_pham"
                  [(ngModel)]="tenSanPham"
                  [ngModelOptions]="{ standalone: true }"
                  (input)="timKiemPhanTichSanPham()"
                  (change)="timKiemPhanTichSanPham()"
                />
                <datalist id="PTSP_ten_san_pham">
                  <option *ngFor="let item of danhSachSanPhams">{{ item.name }}</option>
                </datalist>
              </div>
              <div class="checkbox-group">
                <label class="label_checkAll">
                  <input type="checkbox" class="ui-checkbox" [checked]="checkedAll" (change)="checkAll()" />
                  <span> Chọn tất cả </span>
                </label>
              </div>
            </div>
            <table class="table tablel-striped" aria-describedby="page-heading">
              <thead style="background-color: #006699">
                <tr jhiSort [(predicate)]="predicate" [(ascending)]="ascending">
                  <th scope="col" jhiSortBy="id" class="header-table-custom" style="width: 3rem">
                    <span class="span-table-phantich">Option</span>
                  </th>
                  <th scope="col" jhiSortBy="id" style="width: 6rem; font-size: 12px">
                    <span class="span-table-phantich">STT</span>
                  </th>
                  <th scope="col" jhiSortBy="id" style="width: 25rem; font-size: 12px">
                    <span class="span-table-phantich">Tên sản phẩm</span>
                  </th>
                  <th scope="col" jhiSortBy="id" class="header-table-custom" style="width: 12rem; font-size: 12px">
                    <span class="span-table-phantich">Tình trạng</span>
                  </th>
                  <th scope="col" jhiSortBy="id" class="header-table-custom" style="width: 6rem; font-size: 12px">
                    <span class="span-table-phantich">SL nhận</span>
                  </th>
                  <th scope="col" jhiSortBy="id" class="header-table-custom" style="width: 6rem; font-size: 12px">
                    <span class="span-table-phantich">SL đã phân tích</span>
                  </th>
                  <th scope="col" jhiSortBy="id" class="header-table-custom" style="width: 6rem; font-size: 12px">
                    <span class="span-table-phantich">SL còn lại</span>
                  </th>
                  <th scope="col" jhiSortBy="id" class="header-table-custom" style="width: 8rem; font-size: 12px">
                    <span class="span-table-phantich">Tiến độ (%)</span>
                  </th>
                  <th scope="col" jhiSortBy="id" class="header-table-custom" style="width: 6rem; font-size: 12px">
                    <span class="span-table-phantich">Checked</span>
                    <!-- <input type="checkbox" class="ui-checkbox" [checked]="checkedAll" (change)="checkAll()" /> -->
                  </th>
                </tr>
              </thead>
              <tbody>
                <tr *ngFor="let data of listOfChiTietSanPhamPhanTich; let i = index">
                  <td>
                    <button class="btn btn-success" (click)="openPopupChiTietLoi(data.id, i)">
                      <fa-icon icon="pencil"></fa-icon>
                    </button>
                  </td>
                  <td><input type="text" class="inp-ptich-sp" value="{{ i + 1 }}" disabled /></td>
                  <td><input type="text" class="inp-ptich-sp" value="{{ data.tenSanPham }}" style="width: 25rem" disabled /></td>
                  <td><input type="text" class="inp-ptich-sp" value="{{ data.tinhTrang }}" disabled /></td>
                  <td><input type="text" class="inp-ptich-sp" value="{{ data.slTiepNhan }}" disabled /></td>
                  <td><input type="text" class="inp-ptich-sp" value="{{ data.slDaPhanTich }}" disabled /></td>
                  <td><input type="text" class="inp-ptich-sp" value="{{ data.slConLai }}" disabled /></td>
                  <td><input type="range" value="{{ data.tienDo }}" id="{{ i }}" />{{ data.tienDo.toFixed(2) }}%</td>
                  <td>
                    <input
                      type="checkbox"
                      class="ui-checkbox"
                      [(ngModel)]="data.check"
                      (click)="checkItem(i)"
                      [ngModelOptions]="{ standalone: true }"
                      [disabled]="data.check"
                    />
                  </td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>
      </form>
    </div>
  </div>
</div>
<!------------------------------------------------------------ popup khai báo lỗi  ---------------------------------------------------------------->
<div class="popup-background nested-overlay" role="dialog" *ngIf="popupChiTietLoi === true">
  <div class="popup-container nested-container fixed-layout">
    <div class="fixed-top">
      <div class="popup-header">
        <h2 class="dialog-title">Phân tích chi tiết sản phẩm</h2>
        <hr />
        <span class="close-btn" (click)="closePopup()">&times;</span>
      </div>
      <div class="popup-content header-content">
        <form>
          <table class="table table-striped" aria-describedby="page-heading">
            <thead style="background-color: #006699">
              <tr jhiSort [(predicate)]="predicate" [(ascending)]="ascending">
                <th scope="col" jhiSortBy="id" style="width: 6em">
                  <span class="span-table-phantich">Mã tiếp nhận</span>
                </th>
                <th scope="col" jhiSortBy="id" style="width: 30em">
                  <span class="span-table-phantich">Tên khách hàng</span>
                </th>
                <th scope="col" jhiSortBy="id" style="width: 6em">
                  <span class="span-table-phantich">Mã sản phẩm</span>
                </th>
                <th scope="col" jhiSortBy="id" style="width: 30em">
                  <span class="span-table-phantich">Tên sản phẩm</span>
                </th>
                <th scope="col" jhiSortBy="id" style="width: 10em">
                  <span class="span-table-phantich">Tình trạng</span>
                </th>
                <th scope="col" jhiSortBy="id" style="width: 6em">
                  <span class="span-table-phantich">SL nhận</span>
                </th>
                <th scope="col" jhiSortBy="id" style="width: 6em">
                  <span class="span-table-phantich">SL đã phân tích</span>
                </th>
                <th scope="col" jhiSortBy="id" style="width: 6em">
                  <span class="span-table-phantich">SL còn lại</span>
                </th>
                <th scope="col" jhiSortBy="id" style="width: 6em">
                  <span class="span-table-phantich">Tiến độ (%)</span>
                </th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>{{ listOfChiTietSanPhamPhanTich[indexOfPhanTichSanPham].maTiepNhan }}</td>
                <td>{{ donBaoHanh.khachHang?.tenKhachHang }}</td>
                <td>{{ listOfChiTietSanPhamPhanTich[indexOfPhanTichSanPham].sanPham?.sapCode }}</td>
                <td>{{ listOfChiTietSanPhamPhanTich[indexOfPhanTichSanPham].tenSanPham }}</td>
                <td>{{ listOfChiTietSanPhamPhanTich[indexOfPhanTichSanPham].tinhTrang }}</td>
                <td>{{ listOfChiTietSanPhamPhanTich[indexOfPhanTichSanPham].slTiepNhan }}</td>
                <td>{{ listOfChiTietSanPhamPhanTich[indexOfPhanTichSanPham].slDaPhanTich }}</td>
                <td>{{ listOfChiTietSanPhamPhanTich[indexOfPhanTichSanPham].slConLai }}</td>
                <td>
                  <input
                    type="range"
                    [(ngModel)]="listOfChiTietSanPhamPhanTich[indexOfPhanTichSanPham].tienDo"
                    [ngModelOptions]="{ standalone: true }"
                    id="chiTietDonBaoHanh"
                  />{{ listOfChiTietSanPhamPhanTich[indexOfPhanTichSanPham].tienDo.toFixed(2) }}%
                </td>
              </tr>
            </tbody>
          </table>
        </form>

        <div class="group-btn-scan">
          <div class="group-scan">
            <div class="group-scan-child">
              <div class="group-btn-lot">
                <!-- <button class="btn btn-primary btn-scan" (click)="buttonScanLot()" *ngIf="scanLot">Scan LOT</button>
                <button class="btn btn-primary btn-scan" (click)="buttonScanSerial()" *ngIf="scanSerial">Scan
                  Serial</button> -->
                <div class="container-serial">
                  <button class="btn btn-info" (click)="openScanLotDialog()" style="height: 2rem; color: #fff">Thông tin sản phẩm</button>

                  <div class="custom-input" style="width: 20%">
                    <input
                      id="serial"
                      type="text"
                      inputmode="none"
                      class="inp-err-nsx container-lot-serial"
                      [(ngModel)]="saveSerial"
                      (ngModelChange)="onScan('serial', $event)"
                      [disabled]="!scanSerial"
                    />
                    <label class="form-label">Serial</label>
                  </div>

                  <div class="custom-input" style="width: 20%">
                    <input
                      id="lot"
                      type="text"
                      inputmode="none"
                      class="inp-err-nsx container-lot-serial"
                      [(ngModel)]="saveLOT"
                      (ngModelChange)="onScan('lot', $event)"
                      [disabled]="!scanLot"
                    />
                    <label class="form-label">LOT</label>
                  </div>

                  <div class="custom-input" style="width: 10%">
                    <input
                      id="field_namSanXuat"
                      placeholder="Năm sản xuất"
                      type="text"
                      inputmode="none"
                      class="inp-err-nsx container-lot-serial"
                      [(ngModel)]="saveYear"
                      [ngModelOptions]="{ standalone: true }"
                      readonly
                    />
                  </div>

                  <button
                    class="btn btn-success"
                    *ngIf="listOfChiTietSanPhamPhanTich[indexOfPhanTichSanPham]?.tienDo === 100"
                    (click)="saveKhaiBaoLoi()"
                  >
                    Lưu
                  </button>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
    <div class="scrollable-middle">
      <h2 class="section-title">Chi tiết lỗi</h2>
      <form>
        <div class="error-grid">
          <div *ngFor="let data of catchChangeOfListKhaiBaoLoi; let i = index" class="error-item">
            <button class="btn-name-error" (click)="catchEventKhaiBaoLoi(i)">
              {{ data.loi.tenLoi }}
            </button>
            <span class="error-note">{{ data.ghiChu }}</span>
            <input
              class="input-errors"
              type="number"
              [(ngModel)]="data.soLuong"
              [ngModelOptions]="{ standalone: true }"
              (ngModelChange)="recalculateErrorSummary(listOfPhanTichSanPhamByPLCTTN[indexOfChiTietPhanTichSanPham])"
            />
          </div>
        </div>
      </form>
    </div>
    <!-- --------------------------------------------- Table chi tiết phân tích sản phẩm--------------------------------------------------- -->
    <div class="fixed-bottom">
      <h2 class="section-title">Chi tiết thông tin sản phẩm</h2>
      <form action="">
        <div class="fixed-header-table">
          <table class="table table-striped">
            <thead style="background-color: #006699">
              <tr>
                <th scope="col">
                  <span class="span-table-phantich">STT</span>
                </th>
                <th scope="col" style="width: 27em">
                  <span class="span-table-phantich">Tên sản phẩm</span>
                  <input
                    type="text"
                    placeholder="Tìm kiếm"
                    class="form-control"
                    list="ten_san_pham"
                    [(ngModel)]="searchKey"
                    [ngModelOptions]="{ standalone: true }"
                  />
                </th>
                <th scope="col">
                  <span class="span-table-phantich">LOT</span>
                  <input
                    type="text"
                    placeholder="Tìm kiếm"
                    class="form-control"
                    list="ten_san_pham"
                    [(ngModel)]="searchKey"
                    [ngModelOptions]="{ standalone: true }"
                  />
                </th>
                <th scope="col">
                  <span class="span-table-phantich">Serial</span>
                  <input
                    type="text"
                    placeholder="Tìm kiếm"
                    class="form-control"
                    list="ten_san_pham"
                    [(ngModel)]="searchKey"
                    [ngModelOptions]="{ standalone: true }"
                  />
                </th>
                <th scope="col" style="width: 10em">
                  <span class="span-table-phantich">Năm sản xuất</span>
                  <input
                    type="text"
                    placeholder="Tìm kiếm"
                    class="form-control"
                    list="ten_san_pham"
                    [(ngModel)]="searchKey"
                    [ngModelOptions]="{ standalone: true }"
                  />
                </th>
                <th scope="col">
                  <span class="span-table-phantich">Tổng lỗi</span>
                </th>
                <th scope="col" style="width: 13em">
                  <span class="span-table-phantich">Nhân viên phân tích</span>
                  <input
                    type="text"
                    placeholder="Tìm kiếm"
                    class="form-control"
                    list="ten_san_pham"
                    [(ngModel)]="searchKey"
                    [ngModelOptions]="{ standalone: true }"
                  />
                </th>
                <th scope="col" style="width: 9em">
                  <span class="span-table-phantich">Ngày kiểm tra</span>
                  <input
                    type="text"
                    placeholder="Tìm kiếm"
                    class="form-control"
                    list="ten_san_pham"
                    [(ngModel)]="searchKey"
                    [ngModelOptions]="{ standalone: true }"
                  />
                </th>
                <th scope="col">
                  <span class="span-table-phantich">Username</span>
                  <input
                    type="text"
                    placeholder="Tìm kiếm"
                    class="form-control"
                    list="ten_san_pham"
                    [(ngModel)]="searchKey"
                    [ngModelOptions]="{ standalone: true }"
                  />
                </th>
                <th scope="col">
                  <span class="span-table-phantich">Trạng thái</span>
                </th>
                <th scope="col">
                  <span class="span-table-phantich">Lỗi kỹ thuật</span>
                </th>
                <th scope="col">
                  <span class="span-table-phantich">Lỗi linh động</span>
                </th>
                <th scope="col">
                  <span class="span-table-phantich">Option</span>
                </th>
              </tr>
            </thead>
            <tbody>
              <tr *ngFor="let data of listOfPhanTichSanPhamByPLCTTN; let i = index">
                <td class="body-column">{{ i + 1 }}</td>
                <td class="body-column">{{ data.tenSanPham }}</td>
                <td class="body-column">{{ data.lotNumber }}</td>
                <td class="body-column">{{ data.detail ? data.detail : '—' }}</td>
                <td class="body-column">{{ data.namSanXuat }}</td>
                <td class="body-column">{{ data.soLuong }}</td>
                <td class="body-column">{{ data.tenNhanVienPhanTich }}</td>
                <td class="body-column">{{ data.ngayKiemTra | date: 'YYYY-MM-dd hh:mm:ss' }}</td>
                <td class="body-column">{{ data.username }}</td>
                <td class="body-column"><input type="checkbox" [(ngModel)]="data.trangThai" [ngModelOptions]="{ standalone: true }" /></td>
                <td class="body-column">{{ data.loiKyThuat }}</td>
                <td class="body-column">{{ data.loiLinhDong }}</td>
                <td class="body-column">
                  <div class="btn-table">
                    <button class="btn btn-danger" (click)="deleteKhaiBaoLoi(i)">
                      <fa-icon [icon]="faTrash"></fa-icon>
                    </button>
                  </div>
                </td>
              </tr>
            </tbody>
          </table>
        </div>
      </form>
    </div>
  </div>
  <!-- Modal nhập LOT -->
  <ng-template #scanLotModal let-modal>
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">Thông tin sản phẩm</h5>
        <button type="button" class="close" aria-label="Close" (click)="modal.dismiss()">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>

      <div class="modal-body">
        <!-- <input type="text" class="form-control" [(ngModel)]="lotInput" placeholder="LOT/Serial"
          (keyup.enter)="handleScanLot(modal)" /> -->
        <div class="text-center my-3" *ngIf="isLoading">
          <div class="spinner-border text-primary" role="status">
            <span class="sr-only">Đang tải...</span>
          </div>
          <p class="mt-2">Đang tải dữ liệu...</p>
        </div>
        <div *ngIf="listOfSanPhamTrongDialog.length == 0">
          <h2 class="text-center my-3">Vui lòng scan mã ở ngoài để xem thêm thông tin</h2>
        </div>
        <table class="table table-striped mt-3" *ngIf="listOfSanPhamTrongDialog.length > 0">
          <thead style="background-color: #006699; color: #fff">
            <tr>
              <th scope="col" style="width: 30px">STT</th>
              <th style="width: 20rem">Tên sản phẩm</th>
              <th>LOT</th>
              <th>Vendor</th>
              <th>PartNumber</th>
              <th>Sap</th>
              <th>Username</th>
              <th>Nhân viên phân tích</th>
              <th>Ngày kiểm tra</th>
              <!-- <th style="width: 30px">Options</th> -->
            </tr>
          </thead>
          <tbody>
            <tr *ngFor="let item of listOfSanPhamTrongDialog">
              <td class="body-column">{{ item.stt }}</td>
              <td class="body-column">{{ item.tenSanPham }}</td>
              <td class="body-column">{{ item.lotNumber }}</td>
              <td class="body-column">{{ item.vendor }}</td>
              <td class="body-column">{{ item.partNumber }}</td>
              <td class="body-column">{{ item.sap }}</td>
              <td class="body-column">{{ item.username }}</td>
              <td class="body-column">{{ item.tenNhanVienPhanTich }}</td>
              <td class="body-column">{{ item.ngayKiemTra | date: 'dd/MM/yyyy' }}</td>
              <!-- <td class="body-column">
                <button class="btn btn-sm btn-primary" (click)="openChiTiet(item)">
                  <fa-icon [icon]="faEye"></fa-icon>
                </button>
              </td> -->
            </tr>
          </tbody>
        </table>
      </div>
      <div class="modal-footer">
        <button class="btn btn-secondary" (click)="modal.dismiss()">Đóng</button>
      </div>
    </div>
  </ng-template>
</div>

<!--------------------------------------------------------- popup in bb --------------------------------------------------------------------->
<div class="table-responsive popup-background" role="dialog" *ngIf="popupSelectButton === true">
  <div class="popup-container-btn">
    <div class="popup-header-btn">
      <!-- <button class="btn btn-outline-primary btn-option btn-addTN me-2" style="height: 2.5rem" (click)="testapi()" >Apply</button> -->

      <h2>Chọn kiểu biên bản in</h2>
      <span class="close-btn" (click)="closePopupBtn()" style="float: right">&times;</span>
    </div>
    <div id="hiddenToolbar" class="group-btn-inBBPT">
      <div>
        <div class="group-select-btn-in">
          <span class="label-btn-select-bb">Trạng thái: {{ trangThaiInTN }} </span>
          <button type="button" class="btn btn-primary btn-options-in btn-popup-in" (click)="openPopupBBTN()">Biên bản tiếp nhận</button>
        </div>
      </div>

      <div>
        <div class="group-select-btn-in">
          <span class="label-btn-select-bb">Trạng thái: {{ trangThaiInKN }} {{ maKhoPrint }}</span>
          <button type="button" class="btn btn-primary btn-options-in btn-popup-in" (click)="showGroupOptionsKN()">
            Biên bản kiểm nghiệm
          </button>
        </div>

        <div class="group-btn-options" *ngIf="groupOptionsKN === true">
          <table class="table table-striped">
            <tbody>
              <td class="inventory-name">
                <tr *ngFor="let data of resultOfSanPhamTheoKho; let i = index" style="border: none">
                  <button *ngIf="data.key" class="btn btn-primary btn-options-in btn-options-in-pt" (click)="openPopupInBBKN(i, data.key)">
                    {{ data.key }}: {{ data.value.length }} SP
                  </button>
                </tr>
              </td>
            </tbody>
          </table>
        </div>
      </div>
      <div>
        <div class="group-select-btn-in">
          <span class="label-btn-select-bb">Trạng thái: {{ trangThaiInTL }} {{ maKhoPrint }}</span>
          <button type="button" class="btn btn-primary btn-options-in btn-popup-in-2" (click)="showGroupOptionsTL()">
            Biên bản thanh lý
          </button>
        </div>
        <div class="group-btn-options" *ngIf="groupOptionsTL === true">
          <table class="table table-striped">
            <tbody>
              <td class="inventory-name">
                <tr *ngFor="let data of resultOfSanPhamTheoKhoTL; let i = index" style="border: none">
                  <button *ngIf="data.key" class="btn btn-primary btn-options-in btn-options-in-pt" (click)="openPopupInBBTL(i, data.key)">
                    {{ data.key }}: {{ data.value.length }} SP
                  </button>
                </tr>
              </td>
            </tbody>
          </table>
        </div>
      </div>
    </div>
  </div>
  <!-- ------------------------------------------------------ popup chi tiết lỗi của tất cả sản phẩm theo đơn bảo hành ----------------------->
  <div class="table-responsive popup-background" role="dialog" *ngIf="popupShowChiTietLoi === true">
    <div class="popup-container">
      <div class="popup-header">
        <h2>Thông tin chi tiết lỗi của sản phẩm</h2>
        <hr />
        <span class="close-btn" (click)="closePopupShowChiTietLoi()">&times;</span>
      </div>
      <div class="popup-content">
        <form>
          <table class="table table-striped" aria-describedby="page-heading">
            <thead style="background-color: #006699">
              <tr jhiSort [(predicate)]="predicate" [(ascending)]="ascending">
                <th scope="col" jhiSortBy="id">
                  <span class="span-table-phantich">Mã tiếp nhận</span>
                </th>
                <th scope="col" jhiSortBy="id">
                  <span class="span-table-phantich">Khách hàng</span>
                </th>
                <th scope="col" jhiSortBy="id">
                  <span class="span-table-phantich">Tổng tiếp nhận</span>
                </th>
                <th scope="col" jhiSortBy="id">
                  <span class="span-table-phantich">Đã xử lý</span>
                </th>
                <th scope="col" jhiSortBy="id">
                  <span class="span-table-phantich">Tiến độ</span>
                </th>
                <th scope="col" jhiSortBy="id">
                  <span class="span-table-phantich">Ngày tiếp nhận</span>
                </th>
                <th scope="col" jhiSortBy="id">
                  <span class="span-table-phantich">Trạng thái</span>
                </th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
              </tr>
            </tbody>
          </table>
        </form>
        <br />
        <br />
        <h2>Chi tiết thông tin sản phẩm</h2>
        <div>
          <table class="table table-striped">
            <thead style="background-color: #006699">
              <tr>
                <th scope="col">
                  <span class="span-table-phantich">STT</span>
                  <!-- <input class="inp-hidden" style="height: 35px" disabled /> -->
                </th>
                <th scope="col" style="width: 40em">
                  <span class="span-table-phantich">Tên sản phẩmdas</span>
                  <!-- <input
                    type="text"
                    placeholder="Tìm kiếm"
                    class="form-control"
                    list="ten_san_pham"
                    [(ngModel)]="searchKey"
                    [ngModelOptions]="{ standalone: true }"
                  /> -->
                </th>
                <th scope="col">
                  <span class="span-table-phantich">Mã sản phẩm</span>
                  <!-- <input
                    type="text"
                    placeholder="Tìm kiếm"
                    class="form-control"
                    list="ten_san_pham"
                    [(ngModel)]="searchKey"
                    [ngModelOptions]="{ standalone: true }"
                  /> -->
                </th>
                <th scope="col">
                  <span class="span-table-phantich">Số lô</span>
                  <!-- <input
                    type="text"
                    placeholder="Tìm kiếm"
                    class="form-control"
                    list="ten_san_pham"
                    [(ngModel)]="searchKey"
                    [ngModelOptions]="{ standalone: true }"
                  /> -->
                </th>
                <th scope="col">
                  <span class="span-table-phantich">LOT Number</span>
                  <!-- <input
                    type="text"
                    placeholder="Tìm kiếm"
                    class="form-control"
                    list="ten_san_pham"
                    [(ngModel)]="searchKey"
                    [ngModelOptions]="{ standalone: true }"
                  /> -->
                </th>
                <th scope="col">
                  <span class="span-table-phantich">Năm sản xuất</span>
                  <!-- <input
                    type="text"
                    placeholder="Tìm kiếm"
                    class="form-control"
                    list="ten_san_pham"
                    [(ngModel)]="searchKey"
                    [ngModelOptions]="{ standalone: true }"
                  /> -->
                </th>
                <th scope="col">
                  <span class="span-table-phantich">Tổng lỗi</span>
                  <!-- <input
                    type="text"
                    placeholder="Tìm kiếm"
                    class="form-control"
                    list="ten_san_pham"
                    [(ngModel)]="searchKey"
                    [ngModelOptions]="{ standalone: true }"
                  /> -->
                </th>
                <th scope="col">
                  <span class="span-table-phantich">Nhân viên phân tích</span>
                  <!-- <input
                    type="text"
                    placeholder="Tìm kiếm"
                    class="form-control"
                    list="ten_san_pham"
                    [(ngModel)]="searchKey"
                    [ngModelOptions]="{ standalone: true }"
                  /> -->
                </th>
                <th scope="col">
                  <span class="span-table-phantich">Ngày kiểm tra</span>
                  <!-- <input
                    type="text"
                    placeholder="Tìm kiếm"
                    class="form-control"
                    list="ten_san_pham"
                    [(ngModel)]="searchKey"
                    [ngModelOptions]="{ standalone: true }"
                  /> -->
                </th>
                <th scope="col">
                  <span class="span-table-phantich">Username</span>
                  <!-- <input
                    type="text"
                    placeholder="Tìm kiếm"
                    class="form-control"
                    list="ten_san_pham"
                    [(ngModel)]="searchKey"
                    [ngModelOptions]="{ standalone: true }"
                  /> -->
                </th>
                <th scope="col">
                  <span class="span-table-phantich">Trạng thái</span>
                  <!-- <input
                    type="text"
                    placeholder="Tìm kiếm"
                    class="form-control"
                    list="ten_san_pham"
                    [(ngModel)]="searchKey"
                    [ngModelOptions]="{ standalone: true }"
                  /> -->
                </th>
                <th scope="col">
                  <span class="span-table-phantich">Lỗi kỹ thuật</span>
                  <!-- <input
                    type="text"
                    placeholder="Tìm kiếm"
                    class="form-control"
                    list="ten_san_pham"
                    [(ngModel)]="searchKey"
                    [ngModelOptions]="{ standalone: true }"
                  /> -->
                </th>
                <th scope="col">
                  <span class="span-table-phantich">Lỗi linh động</span>
                  <!-- <input
                    type="text"
                    placeholder="Tìm kiếm"
                    class="form-control"
                    list="ten_san_pham"
                    [(ngModel)]="searchKey"
                    [ngModelOptions]="{ standalone: true }"
                  /> -->
                </th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td class="body-column"></td>
                <td class="body-column"></td>
                <td class="body-column"></td>
                <td class="body-column"></td>
                <td class="body-column"></td>
                <td class="body-column"></td>
                <td class="body-column"></td>
                <td class="body-column"></td>
                <td class="body-column"></td>
                <td class="body-column"></td>
                <td class="body-column"></td>
                <td class="body-column"></td>
                <td class="body-column"></td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
    </div>
  </div>

  <!-- In biên bản tiếp nhận -->
  <!-- <div class="table-responive popup-background-bienban" role="dialog" *ngIf="popupInBBTN === true">
    <div class="popup-container popup-in">
      <div class="popup-header-in">
        <span class="close-btn" style="float: right" (click)="closePopupBBTN()">&times;</span>
        <div id="hiddenToolbar">
          <button type="button" class="btn btn-primary" printTitle="BIÊN BẢN GIAO NHẬN SẢN PHẨM ĐỔI"
            (click)="xacNhanInBienBan()" printSectionId="BBTN" style="position:relative; z-index:5" ngxPrint>
            In
          </button>
          <button type="button" class="btn btn-success" style="float: right" (click)="addRow()">Thêm dòng</button>
        </div>
        <div id="BBTN">
          <div id="lien1">
            <header>
              <div class="row">
                <div class="col-6" align="left" style="height: 0px">
                  <img src="../../../../content/images/logoRD.png" alt="CÔNG TY CP BÓNG ĐÈN PHÍCH NƯỚC RẠNG ĐÔNG"
                    width="150" style="margin-top: -30px; margin-left: 30px" />
                </div>
                <div class="col-6" align="right">RĐ.QID05.BM01 Ban hành lần 1</div>
              </div>
            </header>
            <div align="center">
              <h3 style="margin-top: -20px">BIÊN BẢN GIAO NHẬN SẢN PHẨM ĐỔI</h3>
              <p style="text-align: center">
                {{ danhSachLienBienBanTiepNhan[indexOfdanhSachLienBienBanTiepNhan].name }}:
                {{ danhSachLienBienBanTiepNhan[indexOfdanhSachLienBienBanTiepNhan].value }}
              </p>
            </div>
            <div align="right" style="margin-right: 99px; font-size: 12px; margin-top: -30px">Số: {{ maBienBan }}</div>
            <br />
            <div style="display: flex; justify-content: space-between">
              <div>
                <p>
                  Ngày {{ donBaoHanh.maTiepNhan.substr(3, 2) }} tháng {{ donBaoHanh.maTiepNhan.substr(5, 2) }} năm 20{{
                  donBaoHanh.maTiepNhan.substr(7, 2)
                  }}
                  Công ty CP Bóng đèn Phích nước Rạng Đông nhận sản phẩm đổi của
                </p>
                <p>Ông (Bà): {{ donBaoHanh.khachHang.tenKhachHang }}</p>
                <p>Địa chỉ: {{ donBaoHanh.khachHang.diaChi }}</p>
                <div>Kèm giấy đề nghị đổi sản phẩm (nếu có) ngày ... tháng ... năm 20...</div>
              </div>
              <div>
                <div align="right" style="margin-right: 106px">
                  <qrcode [qrdata]="donBaoHanh.maTiepNhan" [width]="10" [errorCorrectionLevel]="'M'"
                    [elementType]="'img'"></qrcode>
                </div>
                <br />
                <div align="right" style="margin-right: 112px; font-size: 12px; margin-top: -30px">{{
                  donBaoHanh.maTiepNhan }}</div>
              </div>
            </div>
            <div>
              <table id="table" class="table-TN" style="min-width: auto; border-spacing: 0px">
                <thead>
                  <tr>
                    <th style="width: 1rem; border: 0.2px solid black">STT</th>
                    <th style="width: 30rem; border: 0.2px solid black">Tên sản phẩm</th>
                    <th style="width: 3rem; border: 0.2px solid black">Đ.vị tính</th>
                    <th style="width: 4rem; border: 0.2px solid black">SL khách giao</th>
                    <th style="width: 4rem; border: 0.2px solid black">SL thực nhận</th>
                    <th style="width: 3rem; border: 0.2px solid black">SL SP đổi mới</th>
                    <th style="width: 3.5rem; border: 0.2px solid black">SL SP sửa chữa</th>
                    <th style="width: 4rem; border: 0.2px solid black">SL SP không được bảo hành</th>
                    <th style="width: 5rem; border: 0.2px solid black">Lý do không bảo hành</th>
                    <th style="width: 5rem; border: 0.2px solid black">Lý do sửa chữa</th>
                  </tr>
                </thead>
                <tbody class="body-table" *ngFor="let data of resultChiTietSanPhamTiepNhans; let i = index">
                  <td style="border: 0.2px solid black">{{ i + 1 }}</td>
                  <td style="border: 0.2px solid black">
                    <input style="width: 30rem; border: none" type="text" [(ngModel)]="data.tenSanPham"
                      [ngModelOptions]="{ standalone: true }" />
                  </td>
                  <td style="border: 0.2px solid black">
                    <input style="width: 3rem; border: none" type="text" [(ngModel)]="data.donVi"
                      [ngModelOptions]="{ standalone: true }" />
                  </td>
                  <td style="border: 0.2px solid black">
                    <input style="width: 4rem; border: none" type="text" [(ngModel)]="data.slKhachGiao"
                      [ngModelOptions]="{ standalone: true }" />
                  </td>
                  <td style="border: 0.2px solid black">
                    <input style="width: 4rem; border: none" type="text" [(ngModel)]="data.slTiepNhan"
                      [ngModelOptions]="{ standalone: true }" />
                  </td>
                  <td style="border: 0.2px solid black">
                    <input style="width: 3rem; border: none" type="text" [(ngModel)]="data.slDoiMoi"
                      [ngModelOptions]="{ standalone: true }" />
                  </td>
                  <td style="border: 0.2px solid black">
                    <input style="width: 3.5rem; border: none" type="text" [(ngModel)]="data.slSuaChua"
                      [ngModelOptions]="{ standalone: true }" />
                  </td>
                  <td style="border: 0.2px solid black">
                    <input style="width: 4rem; border: none" type="text" [(ngModel)]="data.slKhongBaoHanh"
                      [ngModelOptions]="{ standalone: true }" />
                  </td>
                  <td style="border: 0.2px solid black"><input style="width: 10rem; border: none" type="text" /></td>
                  <td style="border: 0.2px solid black"><input style="width: 10rem; border: none" type="text" /></td>
                </tbody>
              </table>
            </div>
            <div class="notes">
              <p>
                Biên bản được lập thành 03 liên (hoặc 4 liên): liên 1 lưu Tổ bảo hành sản phẩm, liên 2 giao khách hàng,
                liên 3 giao P. Kh,
                liên 4 giao P. BH1 (Với trường hợp khách hàng là C1, 2 Miền Bắc). Đối với chi nhánh (2 liên): liên 1 lưu
                chi nhánh, liên 2
                giao khách hàng
              </p>
              <p><strong>Lưu ý: Khi khách hàng lấy sản phẩm đổi, phải giao liên 2 cho thủ kho công ty</strong></p>
            </div>
            <footer>
              <div class="row" style="margin-left: -4rem; display: flex; justify-content: space-around">
                <div class="col" style="text-align: center"><strong>ĐẠI DIỆN KHÁCH HÀNG</strong></div>
                <div class="col" style="text-align: center"><strong>BẢO VỆ</strong></div>
                <div class="col" style="text-align: center">
                  <strong>TỔ BẢO HÀNH SẢN PHẨM</strong><br />
                  <a [href]="selectedValue"
                    style="display: block; margin-top: 6rem; text-decoration: none; color: black">{{
                    selectedValue
                    }}</a>
                </div>
              </div>
            </footer>
          </div>
        </div>
        <select style="float: right; margin-right: 12em" (change)="onSelectChanged($event)">
          <option value="Đỗ Văn Việt">Đỗ Văn Việt</option>
          <option value="Phạm Văn Mạnh">Phạm Văn Mạnh</option>
          <option value="Trần Thạc Nguyên">Trần Thạc Nguyên</option>
          <option value="Nguyễn Văn Tiến">Nguyễn Văn Tiến</option>
          <option value="Lê Huy Sang">Lê Huy Sang</option>
          <option value="Phan Đăng Tỵ">Phan Đăng Tỵ</option>
        </select>
      </div>
    </div>
    <p style="page-break-after: always"></p>
  </div> -->

  <!-- In biên bản kiểm nghiệm -->
  <div class="table-responsive popup-background-bienban" role="dialog" *ngIf="popupInBBKN === true">
    <div class="popup-container popup-in">
      <div class="popup-header-in">
        <span class="close-btn" style="float: right" (click)="closePopupBBKN()">&times;</span>
        <div class="hiddenToolbar">
          <button
            type="button"
            class="btn btn-primary"
            printTitle="BIÊN BẢN KIỂM NGHIỆM SẢN PHẨM BẢO HÀNH"
            (click)="xacNhanInBienBan()"
            printSectionId="BBkhoA"
            style="position: relative; z-index: 5"
            ngxPrint
          >
            <fa-icon [icon]="faPrint" style="padding-right: 5px"></fa-icon> In
          </button>
        </div>

        <div id="BBkhoA">
          <header style="display: flex; justify-content: space-between; align-items: center; padding: 0 1rem">
            <div class="row">
              <div class="col-6" align="left" style="height: 0px">
                <img
                  src="../../../../content/images/logoRD.png"
                  alt="CÔNG TY CP BÓNG ĐÈN PHÍCH NƯỚC RẠNG ĐÔNG"
                  width="150"
                  style="margin-top: -30px; margin-left: 30px"
                />
              </div>
            </div>
          </header>
          <div align="center" style="text-align: center; margin-top: 1rem">
            <h5 style="margin: 0">BIÊN BẢN KIỂM NGHIỆM SẢN PHẨM BẢO HÀNH</h5>
            <p>{{ tenKho }}</p>
          </div>
          <div style="font-size: 14px; margin-right: 15px" align="right">RĐ.QID05.BM01 Ban hành lần 1</div>
          <br />
          <br />
          <div align="right" style="margin-right: 45px; font-size: 14px; margin-top: -30px">Số: {{ maBienBan }}</div>
          <br />
          <div style="display: flex; justify-content: space-between">
            <div>
              <p class="xuatxu">Xuất xứ: Lô hàng của ông (bà) {{ donBaoHanh.khachHang.tenKhachHang }}</p>
              <p class="description">
                Căn cứ biên bản giao nhận sản phẩm số {{ bienBanTiepNhan.maBienBan }} ngày {{ dateTN }}
                tháng
                {{ monthTN }} năm 20{{ yearTN }}
              </p>
            </div>
            <div>
              <div align="right" style="margin-right: 50px">
                <qrcode [qrdata]="donBaoHanh.maTiepNhan" [width]="10" [errorCorrectionLevel]="'M'" [elementType]="'img'"></qrcode>
              </div>
              <br />
              <div align="right" style="margin-right: 40px; font-size: 14px; margin-top: -30px; text-align: center; width: 70%">
                {{ donBaoHanh.maTiepNhan }}
              </div>
            </div>
          </div>
          <!-- <div align="right" style="margin-right: 62px">
          Kho: <input type="text" id="khoA" size="10" style="color: black" value="1" disabled />
        </div> -->
          <table id="tableA" class="table-TN" style="width: 100%; border-spacing: 0px">
            <thead>
              <tr>
                <th
                  rowspan="2"
                  style="
                    text-align: center;
                    font-weight: 700;
                    width: 1rem;
                    border-left: 0.5px solid black;
                    border-top: 0.5px solid black;
                    border-bottom: 0.5px solid black;
                  "
                >
                  STT
                </th>
                <th
                  rowspan="2"
                  style="
                    text-align: center;
                    font-weight: 700;
                    width: 30rem;
                    border-left: 0.5px solid black;
                    border-top: 0.5px solid black;
                    border-bottom: 0.5px solid black;
                  "
                >
                  Tên sản phẩm
                </th>
                <th
                  rowspan="2"
                  style="
                    text-align: center;
                    font-weight: 700;
                    width: 3rem;
                    border-left: 0.5px solid black;
                    border-top: 0.5px solid black;
                    border-bottom: 0.5px solid black;
                  "
                >
                  Đ.vị tính
                </th>
                <th
                  rowspan="2"
                  style="
                    text-align: center;
                    font-weight: 700;
                    width: 4rem;
                    border-left: 0.5px solid black;
                    border-top: 0.5px solid black;
                    border-bottom: 0.5px solid black;
                  "
                >
                  SL SP được bảo hành
                </th>
                <th
                  colspan="2"
                  style="
                    text-align: center;
                    font-weight: 700;
                    border-left: 0.5px solid black;
                    border-top: 0.5px solid black;
                    border-bottom: 0.5px solid black;
                  "
                >
                  Mô tả lỗi
                </th>
                <th
                  colspan="2"
                  style="
                    text-align: center;
                    font-weight: 700;
                    border-left: 0.5px solid black;
                    border-top: 0.5px solid black;
                    border-bottom: 0.5px solid black;
                    border-right: 0.5px solid black;
                  "
                >
                  Kết luận, xử lý
                </th>
              </tr>
              <tr>
                <th
                  style="
                    text-align: center;
                    font-weight: 700;
                    width: 5rem;
                    border-left: 0.5px solid black;
                    border-bottom: 0.5px solid black;
                  "
                >
                  Lỗi linh động
                </th>
                <th
                  style="
                    text-align: center;
                    font-weight: 700;
                    width: 5rem;
                    border-left: 0.5px solid black;
                    border-bottom: 0.5px solid black;
                  "
                >
                  Lỗi kỹ thuật
                </th>
                <th
                  style="
                    text-align: center;
                    font-weight: 700;
                    width: 7rem;
                    border-left: 0.5px solid black;
                    border-bottom: 0.5px solid black;
                  "
                >
                  SL SP phải thanh lý(*)
                </th>
                <th
                  style="
                    text-align: center;
                    font-weight: 700;
                    width: 7rem;
                    border-left: 0.5px solid black;
                    border-bottom: 0.5px solid black;
                    border-right: 0.5px solid black;
                  "
                >
                  SL SP sửa chữa thay thế
                </th>
              </tr>
            </thead>
            <tbody id="body-tableA">
              <tr *ngFor="let item of danhSachBienBanSanPhamTheoKho; let i = index">
                <td
                  style="
                    font-weight: 650;
                    height: 36px;
                    border-left: 0.5px solid black;
                    border-bottom: 0.5px solid black;
                    text-align: center;
                  "
                >
                  {{ i + 1 }}
                </td>
                <td style="font-weight: 650; height: 36px; border-left: 0.5px solid black; border-bottom: 0.5px solid black">
                  {{ item.tenSanPham }}
                </td>
                <td
                  style="
                    font-weight: 650;
                    height: 36px;
                    border-left: 0.5px solid black;
                    border-bottom: 0.5px solid black;
                    text-align: center;
                  "
                >
                  {{ item.sanPham!.donVi }}
                </td>
                <td
                  style="
                    font-weight: 650;
                    height: 36px;
                    border-left: 0.5px solid black;
                    border-bottom: 0.5px solid black;
                    text-align: center;
                  "
                >
                  {{ item.slTiepNhan }}
                </td>
                <td
                  style="
                    font-weight: 650;
                    height: 36px;
                    border-left: 0.5px solid black;
                    border-bottom: 0.5px solid black;
                    text-align: center;
                  "
                >
                  {{ item.loiLinhDong }}
                </td>
                <td
                  style="
                    font-weight: 650;
                    height: 36px;
                    border-left: 0.5px solid black;
                    border-bottom: 0.5px solid black;
                    text-align: center;
                  "
                >
                  {{ item.loiKyThuat }}
                </td>
                <td
                  style="
                    font-weight: 650;
                    height: 36px;
                    border-left: 0.5px solid black;
                    border-bottom: 0.5px solid black;
                    text-align: center;
                  "
                >
                  {{ item.slTiepNhan }}
                </td>
                <td
                  style="
                    font-weight: 650;
                    height: 36px;
                    border-left: 0.5px solid black;
                    border-bottom: 0.5px solid black;
                    border-right: 0.5px solid black;
                    text-align: center;
                  "
                >
                  0
                </td>
                <!-- <td>{{}}</td> -->
                <!-- <td>{{}}</td> -->
                <!-- <td>{{}}</td> -->
              </tr>
            </tbody>
          </table>

          <div class="notes">
            <p style="padding-left: 3rem"><i>(*) Số lượng thanh lý là căn cứ để đổi trả sản phẩm mới cho khách hàng</i></p>
            <p style="padding-left: 3rem"><i>(**) Các vật tư, linh kiện đề nghị để sửa chữa, thay thế:</i></p>
            <hr />
            <hr />
          </div>
          <footer>
            <div class="row" style="margin-left: -4rem; display: flex; justify-content: space-around">
              <div class="col" style="text-align: center"><strong>P.TỔNG GIÁM ĐỐC/UQ</strong></div>
              <div class="col" style="text-align: center; margin-right: -2rem">
                <strong>TRƯỞNG BỘ PHẬN</strong>
                <a style="display: block; margin-top: 6rem; text-decoration: none; color: black; font-size: 18px">Trần Hoàng Tùng</a>
              </div>
              <div class="col" style="text-align: center">
                <strong>TỔ BẢO HÀNH SẢN PHẨM</strong> <br />
                <!-- <select class="nhanvien" style="text-align:center; margin-top: 5rem;"></select> -->
                <a [href]="selectedValue" style="font-size: 18px; display: block; margin-top: 6rem; text-decoration: none; color: black">{{
                  selectedValue
                }}</a>
              </div>
            </div>
          </footer>
        </div>
        <select style="float: right; margin-right: 7em" (change)="onSelectChanged($event)">
          <option value="Đỗ Văn Việt">Đỗ Văn Việt</option>
          <option value="Phạm Văn Mạnh">Phạm Văn Mạnh</option>
          <option value="Trần Thạc Nguyên">Trần Thạc Nguyên</option>
          <option value="Nguyễn Văn Tiến">Nguyễn Văn Tiến</option>
          <option value="Lê Huy Sang">Lê Huy Sang</option>
          <option value="Phan Đăng Tỵ">Phan Đăng Tỵ</option>
        </select>
      </div>
    </div>
  </div>

  <!-- In biên bản thanh lý -->
  <div class="table-responsive popup-background-bienban" role="dialog" *ngIf="popupInBBTL === true">
    <div class="popup-container popup-in">
      <div class="popup-header-in">
        <span class="close-btn" style="float: right" (click)="closePopupBBTL()">&times;</span>
        <div class="hiddenToolbar">
          <button
            type="button"
            class="btn btn-primary"
            printTitle="BIÊN BẢN THANH LÝ SẢN PHẨM MẤT PHẨM CHẤT"
            (click)="xacNhanInBienBan()"
            printSectionId="BBTL"
            style="position: relative; z-index: 5"
            ngxPrint
          >
            <fa-icon [icon]="faPrint" style="padding-right: 5px"></fa-icon>In
          </button>
        </div>
        <div id="BBTL">
          <div id="BBkhoA">
            <header style="display: flex; justify-content: space-between; align-items: center; padding: 0 1rem">
              <div class="row">
                <div class="col-6" align="left" style="height: 0px">
                  <img
                    src="../../../../content/images/logoRD.png"
                    alt="CÔNG TY CP BÓNG ĐÈN PHÍCH NƯỚC RẠNG ĐÔNG"
                    width="150"
                    style="margin-top: 0"
                  />
                </div>
              </div>
            </header>
            <div align="center" style="text-align: center; margin-top: 1rem">
              <h5 style="margin: 0">BIÊN BẢN THANH LÝ SẢN PHẨM MẤT PHẨM CHẤT</h5>
              <p>{{ tenKho }}</p>
            </div>
            <div style="font-size: 14px; margin-right: 15px" align="right">RĐ.QID05.BM01 Ban hành lần 1</div>
            <br />
            <br />
            <div align="right" style="margin-right: 45px; font-size: 14px; margin-top: -30px">Số: {{ maBienBan }}</div>
            <br />
            <div style="display: flex; justify-content: space-between">
              <div>
                <div style="padding-left: 2rem">
                  <p class="ngayTN">
                    Ngày {{ dateTN }} tháng {{ monthTN }} năm 20{{ yearTN }} tại Công ty cổ phần Bóng đèn Phích nước Rạng Đông
                  </p>
                  Thành phần:
                </div>

                <div style="padding-left: 4rem">
                  1/ Đại diện Tổ bảo hành sản phẩm <br />
                  2/ Đại diện phòng Bảo vệ <br />
                  3/ Đại diện phòng TKKTTC
                </div>
                <div style="text-indent: 2rem">
                  <p class="description">
                    Căn cứ Biên bản kiểm nghiệm sản phẩm kém chất lượng số {{ bienBanKiemNghiem.maBienBan }} đối với lô hàng đổi của khách
                    hàng tại Biên bản giao nhận sản phẩm đổi số {{ bienBanTiepNhan.maBienBan }} ngày {{ dateTN }} tháng {{ monthTN }} năm
                    20{{ yearTN }}
                  </p>

                  <p>Chúng tôi thống nhất thanh lý số sản phẩm mất phẩm chất như sau :</p>
                </div>
              </div>
              <div>
                <div align="right" style="margin-right: 50px">
                  <qrcode [qrdata]="donBaoHanh.maTiepNhan" [width]="10" [errorCorrectionLevel]="'M'" [elementType]="'img'"></qrcode>
                </div>
                <br />
                <div align="right" style="margin-right: 40px; font-size: 14px; margin-top: -30px; text-align: center; width: 70%">
                  {{ donBaoHanh.maTiepNhan }}
                </div>
              </div>
            </div>

            <table id="tableA" class="table-TN" style="width: 100%; border-spacing: 0px">
              <thead>
                <tr>
                  <th
                    style="
                      text-align: center;
                      font-weight: 700;
                      width: 1rem;
                      border-left: 0.5px solid black;
                      border-top: 0.5px solid black;
                      border-bottom: 0.5px solid black;
                    "
                  >
                    STT
                  </th>
                  <th
                    style="
                      text-align: center;
                      font-weight: 700;
                      width: 30rem;
                      border-left: 0.5px solid black;
                      border-top: 0.5px solid black;
                      border-bottom: 0.5px solid black;
                    "
                  >
                    Tên sản phẩm
                  </th>
                  <th
                    style="
                      text-align: center;
                      font-weight: 700;
                      width: 1rem;
                      border-left: 0.5px solid black;
                      border-top: 0.5px solid black;
                      border-bottom: 0.5px solid black;
                    "
                  >
                    Đ.vị tính
                  </th>
                  <th
                    style="
                      text-align: center;
                      font-weight: 700;
                      width: 5rem;
                      border-left: 0.5px solid black;
                      border-top: 0.5px solid black;
                      border-bottom: 0.5px solid black;
                    "
                  >
                    Số lượng SP thanh lý
                  </th>
                  <th
                    style="
                      text-align: center;
                      font-weight: 700;
                      width: 18rem;
                      border-left: 0.5px solid black;
                      border-top: 0.5px solid black;
                      border-bottom: 0.5px solid black;
                      border-right: 0.5px solid black;
                    "
                  >
                    Hình thức thanh lý
                  </th>
                </tr>
              </thead>
              <tbody id="body-table">
                <tr *ngFor="let item of danhSachBienBanSanPhamTheoKho; let i = index">
                  <td
                    style="
                      font-weight: 650;
                      height: 36px;
                      border-left: 0.5px solid black;
                      border-bottom: 0.5px solid black;
                      text-align: center;
                    "
                  >
                    {{ i + 1 }}
                  </td>
                  <td style="font-weight: 650; height: 36px; border-left: 0.5px solid black; border-bottom: 0.5px solid black">
                    {{ item.tenSanPham }}
                  </td>
                  <td
                    style="
                      font-weight: 650;
                      height: 36px;
                      border-left: 0.5px solid black;
                      border-bottom: 0.5px solid black;
                      text-align: center;
                    "
                  >
                    {{ item.sanPham!.donVi }}
                  </td>
                  <td
                    style="
                      font-weight: 650;
                      height: 36px;
                      border-left: 0.5px solid black;
                      border-bottom: 0.5px solid black;
                      text-align: center;
                    "
                  >
                    {{ item.slTiepNhan }}
                  </td>
                  <td
                    style="
                      font-weight: 650;
                      height: 36px;
                      border-left: 0.5px solid black;
                      border-bottom: 0.5px solid black;
                      border-right: 0.5px solid black;
                    "
                  >
                    Sản phẩm tháo dỡ thanh lý giao cho công ty
                  </td>
                </tr>
              </tbody>
            </table>

            <footer>
              <div class="row" style="margin-left: -4rem; margin-top: 1rem; display: flex; justify-content: space-around">
                <div class="col" style="text-align: center"><strong>P.TỔNG GIÁM ĐỐC/UQ</strong></div>
                <div class="col" style="text-align: center"><strong>PHÒNG TKKTTC</strong></div>
                <div class="col" style="text-align: center"><strong>BẢO VỆ</strong></div>
                <div class="col" style="text-align: center">
                  <strong>TỔ BẢO HÀNH SẢN PHẨM</strong> <br />
                  <!-- <select class="nhanvien" style="text-align:center; margin-top: 5rem;"></select>
                 -->
                  <a [href]="selectedValue" style="display: block; margin-top: 6rem; text-decoration: none; color: black">{{
                    selectedValue
                  }}</a>
                </div>
              </div>
            </footer>
          </div>
        </div>
        <select style="float: right; margin-right: 7em" (change)="onSelectChanged($event)">
          <option value="Đỗ Văn Việt">Đỗ Văn Việt</option>
          <option value="Phạm Văn Mạnh">Phạm Văn Mạnh</option>
          <option value="Trần Thạc Nguyên">Trần Thạc Nguyên</option>
          <option value="Nguyễn Văn Tiến">Nguyễn Văn Tiến</option>
          <option value="Lê Huy Sang">Lê Huy Sang</option>
          <option value="Phan Đăng Tỵ">Phan Đăng Tỵ</option>
        </select>
      </div>
    </div>
  </div>

  <div class="popup-overlay" id="popupNoti" [class.active]="isPopupVisible">
    <div class="popup">
      <h3>{{ popupMessage }}</h3>
      <button (click)="isPopupVisible = false">Close</button>
    </div>
  </div>

  <!-- biên bản tiếp nhận test -->
  <div class="table-responive popup-background-bienban" role="dialog" *ngIf="popupInBBTN === true">
    <div class="popup-container popup-in">
      <div class="popup-header-in">
        <span class="close-btn" style="float: right" (click)="closePopupBBTN()">&times;</span>
        <div id="hiddenToolbar">
          <button
            type="button"
            class="btn btn-primary"
            printTitle="BIÊN BẢN GIAO NHẬN SẢN PHẨM ĐỔI"
            (click)="xacNhanInBienBan()"
            printSectionId="BBTN"
            [printStyle]="{ '#signatureSelect': { display: 'none' } }"
            style="position: relative; z-index: 5"
            ngxPrint
          >
            <fa-icon [icon]="faPrint" style="padding-right: 5px"></fa-icon>In
          </button>
          <!-- <button type="button" class="btn btn-success" style="float: right" (click)="addRow()">Thêm dòng</button> -->
        </div>
        <div id="BBTN">
          <div id="lien1">
            <header style="display: flex; justify-content: space-between; align-items: center; padding: 0 1rem">
              <div class="row">
                <div class="col-6" align="left" style="height: 0px">
                  <img
                    src="../../../../content/images/logoRD.png"
                    alt="CÔNG TY CP BÓNG ĐÈN PHÍCH NƯỚC RẠNG ĐÔNG"
                    width="150"
                    style="margin-top: 0"
                  />
                </div>
              </div>
            </header>
            <div align="center" style="text-align: center; margin-top: 1rem">
              <h3 style="margin: 0">BIÊN BẢN GIAO NHẬN SẢN PHẨM ĐỔI</h3>
              <p style="text-align: center">Liên 1: Lưu tổ phục vụ đổi sản phẩm</p>
            </div>
            <div style="font-size: 14px; margin-right: 15px" align="right">RĐ.QID05.BM01 Ban hành lần 1</div>
            <br />
            <br />
            <div align="right" style="margin-right: 45px; font-size: 14px; margin-top: -30px">Số: {{ maBienBan }}</div>
            <br />
            <div style="display: flex; justify-content: space-between">
              <div>
                <p>
                  Ngày {{ dateTN }} tháng {{ monthTN }} năm 20{{ yearTN }}
                  Công ty CP Bóng đèn Phích nước Rạng Đông nhận sản phẩm đổi của
                </p>
                <p>Ông (Bà): {{ donBaoHanh.khachHang.tenKhachHang }}</p>
                <p>Địa chỉ: {{ donBaoHanh.khachHang.diaChi }}</p>
                <div>Kèm giấy đề nghị đổi sản phẩm (nếu có) ngày ... tháng ... năm 20...</div>
              </div>
              <div>
                <div align="right" style="margin-right: 50px">
                  <qrcode [qrdata]="donBaoHanh.maTiepNhan" [width]="10" [errorCorrectionLevel]="'M'" [elementType]="'img'"></qrcode>
                </div>
                <br />
                <div style="margin-right: 40px; font-size: 14px; margin-top: -30px; text-align: center; width: 70%">
                  {{ donBaoHanh.maTiepNhan }}
                </div>
              </div>
            </div>
            <div>
              <table id="table" class="table-TN" style="width: 100%; border-spacing: 0px">
                <thead>
                  <tr>
                    <th
                      style="
                        text-align: center;
                        font-weight: 700;
                        width: 1rem;
                        border-left: 0.5px solid black;
                        border-top: 0.5px solid black;
                        border-bottom: 0.5px solid black;
                      "
                    >
                      STT
                    </th>
                    <th
                      style="
                        text-align: center;
                        font-weight: 700;
                        width: 30rem;
                        border-left: 0.5px solid black;
                        border-top: 0.5px solid black;
                        border-bottom: 0.5px solid black;
                      "
                    >
                      Tên sản phẩm
                    </th>
                    <th
                      style="
                        text-align: center;
                        font-weight: 700;
                        width: 3rem;
                        border-left: 0.5px solid black;
                        border-top: 0.5px solid black;
                        border-bottom: 0.5px solid black;
                      "
                    >
                      Đ.vị tính
                    </th>
                    <th
                      style="
                        text-align: center;
                        font-weight: 700;
                        width: 4rem;
                        border-left: 0.5px solid black;
                        border-top: 0.5px solid black;
                        border-bottom: 0.5px solid black;
                      "
                    >
                      SL khách giao
                    </th>
                    <th
                      style="
                        text-align: center;
                        font-weight: 700;
                        width: 4rem;
                        border-left: 0.5px solid black;
                        border-top: 0.5px solid black;
                        border-bottom: 0.5px solid black;
                      "
                    >
                      SL thực nhận
                    </th>
                    <th
                      style="
                        text-align: center;
                        font-weight: 700;
                        width: 3rem;
                        border-left: 0.5px solid black;
                        border-top: 0.5px solid black;
                        border-bottom: 0.5px solid black;
                      "
                    >
                      SL SP đổi mới
                    </th>
                    <th
                      style="
                        text-align: center;
                        font-weight: 700;
                        width: 3.5rem;
                        border-left: 0.5px solid black;
                        border-top: 0.5px solid black;
                        border-bottom: 0.5px solid black;
                      "
                    >
                      SL SP sửa chữa
                    </th>
                    <th
                      style="
                        text-align: center;
                        font-weight: 700;
                        width: 4rem;
                        border-left: 0.5px solid black;
                        border-top: 0.5px solid black;
                        border-bottom: 0.5px solid black;
                      "
                    >
                      SL SP không được bảo hành
                    </th>
                    <th
                      style="
                        text-align: center;
                        font-weight: 700;
                        width: 10rem;
                        border-left: 0.5px solid black;
                        border-top: 0.5px solid black;
                        border-bottom: 0.5px solid black;
                      "
                    >
                      Lý do không bảo hành
                    </th>
                    <th style="text-align: center; font-weight: 700; width: 10rem; border: 0.5px solid black">Lý do sửa chữa</th>
                  </tr>
                </thead>
                <tbody class="body-table" *ngFor="let data of resultChiTietSanPhamTiepNhans; let i = index">
                  <td
                    style="
                      font-weight: 650;
                      height: 36px;
                      border-left: 0.5px solid black;
                      border-bottom: 0.5px solid black;
                      text-align: center;
                    "
                  >
                    {{ i + 1 }}
                  </td>
                  <td style="font-weight: 650; height: 36px; border-left: 0.5px solid black; border-bottom: 0.5px solid black">
                    {{ data.tenSanPham }}
                  </td>
                  <td
                    style="
                      font-weight: 650;
                      height: 36px;
                      border-left: 0.5px solid black;
                      border-bottom: 0.5px solid black;
                      text-align: center;
                    "
                  >
                    {{ data.donVi }}
                  </td>
                  <td
                    style="
                      font-weight: 650;
                      height: 36px;
                      border-left: 0.5px solid black;
                      border-bottom: 0.5px solid black;
                      text-align: center;
                    "
                  >
                    {{ data.slKhachGiao }}
                  </td>
                  <td
                    style="
                      font-weight: 650;
                      height: 36px;
                      border-left: 0.5px solid black;
                      border-bottom: 0.5px solid black;
                      text-align: center;
                    "
                  >
                    {{ data.slTiepNhan }}
                  </td>
                  <td
                    style="
                      font-weight: 650;
                      height: 36px;
                      border-left: 0.5px solid black;
                      border-bottom: 0.5px solid black;
                      text-align: center;
                    "
                  >
                    {{ data.slDoiMoi }}
                  </td>
                  <td
                    style="
                      font-weight: 650;
                      height: 36px;
                      border-left: 0.5px solid black;
                      border-bottom: 0.5px solid black;
                      text-align: center;
                    "
                  >
                    {{ data.slSuaChua }}
                  </td>
                  <td
                    style="
                      font-weight: 650;
                      height: 36px;
                      border-left: 0.5px solid black;
                      border-bottom: 0.5px solid black;
                      text-align: center;
                    "
                  >
                    {{ data.slKhongBaoHanh }}
                  </td>
                  <td style="font-weight: 650; height: 36px; border-left: 0.5px solid black; border-bottom: 0.5px solid black"></td>
                  <td
                    style="
                      font-weight: 650;
                      height: 36px;
                      border-left: 0.5px solid black;
                      border-bottom: 0.5px solid black;
                      border-right: 0.5px solid black;
                    "
                  ></td>
                </tbody>
              </table>
            </div>
            <div class="notes">
              <p>
                Biên bản được lập thành 03 liên (hoặc 4 liên): liên 1 lưu Tổ bảo hành sản phẩm, liên 2 giao khách hàng, liên 3 giao P. Kh,
                liên 4 giao P. BH1 (Với trường hợp khách hàng là C1, 2 Miền Bắc). Đối với chi nhánh (2 liên): liên 1 lưu chi nhánh, liên 2
                giao khách hàng
              </p>
              <p><strong>Lưu ý: Khi khách hàng lấy sản phẩm đổi, phải giao liên 2 cho thủ kho công ty</strong></p>
            </div>
            <footer>
              <div class="row" style="margin-left: -4rem; display: flex; justify-content: space-around">
                <div class="col" style="text-align: center"><strong>ĐẠI DIỆN KHÁCH HÀNG</strong></div>
                <div class="col" style="text-align: center"><strong>BẢO VỆ</strong></div>
                <div class="col" style="text-align: center">
                  <strong>TỔ BẢO HÀNH SẢN PHẨM</strong><br />
                  <a [href]="selectedValue" style="display: block; margin-top: 6rem; text-decoration: none; color: black">{{
                    selectedValue
                  }}</a>
                  <select id="signatureSelect" style="float: right; margin-right: 7em" (change)="onSelectChanged($event)">
                    <option value="Đỗ Văn Việt">Đỗ Văn Việt</option>
                    <option value="Phạm Văn Mạnh">Phạm Văn Mạnh</option>
                    <option value="Trần Thạc Nguyên">Trần Thạc Nguyên</option>
                    <option value="Nguyễn Văn Tiến">Nguyễn Văn Tiến</option>
                    <option value="Lê Huy Sang">Lê Huy Sang</option>
                    <option value="Phan Đăng Tỵ">Phan Đăng Tỵ</option>
                  </select>
                </div>
              </div>
            </footer>
          </div>

          <p style="page-break-after: always"></p>
          <br />
          <br />

          <header style="display: flex; justify-content: space-between; align-items: center; padding: 0 1rem">
            <div class="row">
              <div class="col-6" align="left" style="height: 0px">
                <img
                  src="../../../../content/images/logoRD.png"
                  alt="CÔNG TY CP BÓNG ĐÈN PHÍCH NƯỚC RẠNG ĐÔNG"
                  width="150"
                  style="margin-top: 0"
                />
              </div>
            </div>
          </header>
          <div align="center" style="text-align: center; margin-top: 1rem">
            <h3 style="margin: 0">BIÊN BẢN GIAO NHẬN SẢN PHẨM ĐỔI</h3>
            <p style="text-align: center">Liên 2: Khách hàng</p>
          </div>
          <div style="font-size: 14px; margin-right: 15px" align="right">RĐ.QID05.BM01 Ban hành lần 1</div>
          <br />
          <br />
          <div align="right" style="margin-right: 45px; font-size: 14px; margin-top: -30px">Số: {{ maBienBan }}</div>
          <br />
          <div style="display: flex; justify-content: space-between">
            <div>
              <p>
                Ngày {{ dateTN }} tháng {{ monthTN }} năm 20{{ yearTN }}
                Công ty CP Bóng đèn Phích nước Rạng Đông nhận sản phẩm đổi của
              </p>
              <p>Ông (Bà): {{ donBaoHanh.khachHang.tenKhachHang }}</p>
              <p>Địa chỉ: {{ donBaoHanh.khachHang.diaChi }}</p>
              <div>Kèm giấy đề nghị đổi sản phẩm (nếu có) ngày ... tháng ... năm 20...</div>
            </div>
            <div>
              <div align="right" style="margin-right: 50px">
                <qrcode [qrdata]="donBaoHanh.maTiepNhan" [width]="10" [errorCorrectionLevel]="'M'" [elementType]="'img'"></qrcode>
              </div>
              <br />
              <div style="margin-right: 40px; font-size: 14px; margin-top: -30px; text-align: center; width: 70%">
                {{ donBaoHanh.maTiepNhan }}
              </div>
            </div>
          </div>
          <div>
            <table id="table" class="table-TN" style="width: 100%; border-spacing: 0px">
              <thead>
                <tr>
                  <th
                    style="
                      text-align: center;
                      font-weight: 700;
                      width: 1rem;
                      border-left: 0.5px solid black;
                      border-top: 0.5px solid black;
                      border-bottom: 0.5px solid black;
                    "
                  >
                    STT
                  </th>
                  <th
                    style="
                      text-align: center;
                      font-weight: 700;
                      width: 30rem;
                      border-left: 0.5px solid black;
                      border-top: 0.5px solid black;
                      border-bottom: 0.5px solid black;
                    "
                  >
                    Tên sản phẩm
                  </th>
                  <th
                    style="
                      text-align: center;
                      font-weight: 700;
                      width: 3rem;
                      border-left: 0.5px solid black;
                      border-top: 0.5px solid black;
                      border-bottom: 0.5px solid black;
                    "
                  >
                    Đ.vị tính
                  </th>
                  <th
                    style="
                      text-align: center;
                      font-weight: 700;
                      width: 4rem;
                      border-left: 0.5px solid black;
                      border-top: 0.5px solid black;
                      border-bottom: 0.5px solid black;
                    "
                  >
                    SL khách giao
                  </th>
                  <th
                    style="
                      text-align: center;
                      font-weight: 700;
                      width: 4rem;
                      border-left: 0.5px solid black;
                      border-top: 0.5px solid black;
                      border-bottom: 0.5px solid black;
                    "
                  >
                    SL thực nhận
                  </th>
                  <th
                    style="
                      text-align: center;
                      font-weight: 700;
                      width: 3rem;
                      border-left: 0.5px solid black;
                      border-top: 0.5px solid black;
                      border-bottom: 0.5px solid black;
                    "
                  >
                    SL SP đổi mới
                  </th>
                  <th
                    style="
                      text-align: center;
                      font-weight: 700;
                      width: 3.5rem;
                      border-left: 0.5px solid black;
                      border-top: 0.5px solid black;
                      border-bottom: 0.5px solid black;
                    "
                  >
                    SL SP sửa chữa
                  </th>
                  <th
                    style="
                      text-align: center;
                      font-weight: 700;
                      width: 4rem;
                      border-left: 0.5px solid black;
                      border-top: 0.5px solid black;
                      border-bottom: 0.5px solid black;
                    "
                  >
                    SL SP không được bảo hành
                  </th>
                  <th
                    style="
                      text-align: center;
                      font-weight: 700;
                      width: 10rem;
                      border-left: 0.5px solid black;
                      border-top: 0.5px solid black;
                      border-bottom: 0.5px solid black;
                    "
                  >
                    Lý do không bảo hành
                  </th>
                  <th style="text-align: center; font-weight: 700; width: 10rem; border: 0.5px solid black">Lý do sửa chữa</th>
                </tr>
              </thead>
              <tbody class="body-table" *ngFor="let data of resultChiTietSanPhamTiepNhans; let i = index">
                <td style="height: 36px; border-left: 0.5px solid black; border-bottom: 0.5px solid black; text-align: center">
                  {{ i + 1 }}
                </td>
                <td style="font-weight: 650; height: 36px; border-left: 0.5px solid black; border-bottom: 0.5px solid black">
                  {{ data.tenSanPham }}
                </td>
                <td
                  style="
                    font-weight: 650;
                    height: 36px;
                    border-left: 0.5px solid black;
                    border-bottom: 0.5px solid black;
                    text-align: center;
                  "
                >
                  {{ data.donVi }}
                </td>
                <td
                  style="
                    font-weight: 650;
                    height: 36px;
                    border-left: 0.5px solid black;
                    border-bottom: 0.5px solid black;
                    text-align: center;
                  "
                >
                  {{ data.slKhachGiao }}
                </td>
                <td
                  style="
                    font-weight: 650;
                    height: 36px;
                    border-left: 0.5px solid black;
                    border-bottom: 0.5px solid black;
                    text-align: center;
                  "
                >
                  {{ data.slTiepNhan }}
                </td>
                <td
                  style="
                    font-weight: 650;
                    height: 36px;
                    border-left: 0.5px solid black;
                    border-bottom: 0.5px solid black;
                    text-align: center;
                  "
                >
                  {{ data.slDoiMoi }}
                </td>
                <td
                  style="
                    font-weight: 650;
                    height: 36px;
                    border-left: 0.5px solid black;
                    border-bottom: 0.5px solid black;
                    text-align: center;
                  "
                >
                  {{ data.slSuaChua }}
                </td>
                <td
                  style="
                    font-weight: 650;
                    height: 36px;
                    border-left: 0.5px solid black;
                    border-bottom: 0.5px solid black;
                    text-align: center;
                  "
                >
                  {{ data.slKhongBaoHanh }}
                </td>
                <td style="font-weight: 650; height: 36px; border-left: 0.5px solid black; border-bottom: 0.5px solid black"></td>
                <td
                  style="
                    font-weight: 650;
                    height: 36px;
                    border-left: 0.5px solid black;
                    border-bottom: 0.5px solid black;
                    border-right: 0.5px solid black;
                  "
                ></td>
              </tbody>
            </table>
          </div>
          <div class="notes">
            <p>
              Biên bản được lập thành 03 liên (hoặc 4 liên): liên 1 lưu Tổ bảo hành sản phẩm, liên 2 giao khách hàng, liên 3 giao P. Kh,
              liên 4 giao P. BH1 (Với trường hợp khách hàng là C1, 2 Miền Bắc). Đối với chi nhánh (2 liên): liên 1 lưu chi nhánh, liên 2
              giao khách hàng
            </p>
            <p><strong>Lưu ý: Khi khách hàng lấy sản phẩm đổi, phải giao liên 2 cho thủ kho công ty</strong></p>
          </div>
          <footer>
            <div class="row" style="margin-left: -4rem; display: flex; justify-content: space-around">
              <div class="col" style="text-align: center"><strong>ĐẠI DIỆN KHÁCH HÀNG</strong></div>
              <div class="col" style="text-align: center"><strong>BẢO VỆ</strong></div>
              <div class="col" style="text-align: center">
                <strong>TỔ BẢO HÀNH SẢN PHẨM</strong><br />
                <a [href]="selectedValue" style="font-size: 18px; display: block; margin-top: 6rem; text-decoration: none; color: black">{{
                  selectedValue
                }}</a>
              </div>
            </div>
          </footer>
          <p style="page-break-after: always"></p>
          <br />
          <br />

          <header style="display: flex; justify-content: space-between; align-items: center; padding: 0 1rem">
            <div class="row">
              <div class="col-6" align="left" style="height: 0px">
                <img
                  src="../../../../content/images/logoRD.png"
                  alt="CÔNG TY CP BÓNG ĐÈN PHÍCH NƯỚC RẠNG ĐÔNG"
                  width="150"
                  style="margin-top: 0"
                />
              </div>
            </div>
          </header>
          <div align="center" style="text-align: center; margin-top: 1rem">
            <h3 style="margin: 0">BIÊN BẢN GIAO NHẬN SẢN PHẨM ĐỔI</h3>
            <p style="text-align: center">Liên 3: P. KHTT</p>
          </div>
          <div style="font-size: 14px; margin-right: 15px" align="right">RĐ.QID05.BM01 Ban hành lần 1</div>
          <br />
          <br />
          <div align="right" style="margin-right: 45px; font-size: 14px; margin-top: -30px">Số: {{ maBienBan }}</div>
          <br />
          <div style="display: flex; justify-content: space-between">
            <div>
              <p>
                Ngày {{ dateTN }} tháng {{ monthTN }} năm 20{{ yearTN }}
                Công ty CP Bóng đèn Phích nước Rạng Đông nhận sản phẩm đổi của
              </p>
              <p>Ông (Bà): {{ donBaoHanh.khachHang.tenKhachHang }}</p>
              <p>Địa chỉ: {{ donBaoHanh.khachHang.diaChi }}</p>
              <div>Kèm giấy đề nghị đổi sản phẩm (nếu có) ngày ... tháng ... năm 20...</div>
            </div>
            <div>
              <div align="right" style="margin-right: 50px">
                <qrcode [qrdata]="donBaoHanh.maTiepNhan" [width]="10" [errorCorrectionLevel]="'M'" [elementType]="'img'"></qrcode>
              </div>
              <br />
              <div style="margin-right: 40px; font-size: 14px; margin-top: -30px; text-align: center; width: 70%">
                {{ donBaoHanh.maTiepNhan }}
              </div>
            </div>
          </div>
          <div>
            <table id="table" class="table-TN" style="width: 100%; border-spacing: 0px">
              <thead>
                <tr>
                  <th
                    style="
                      text-align: center;
                      font-weight: 700;
                      width: 1rem;
                      border-left: 0.5px solid black;
                      border-top: 0.5px solid black;
                      border-bottom: 0.5px solid black;
                    "
                  >
                    STT
                  </th>
                  <th
                    style="
                      text-align: center;
                      font-weight: 700;
                      width: 30rem;
                      border-left: 0.5px solid black;
                      border-top: 0.5px solid black;
                      border-bottom: 0.5px solid black;
                    "
                  >
                    Tên sản phẩm
                  </th>
                  <th
                    style="
                      text-align: center;
                      font-weight: 700;
                      width: 3rem;
                      border-left: 0.5px solid black;
                      border-top: 0.5px solid black;
                      border-bottom: 0.5px solid black;
                    "
                  >
                    Đ.vị tính
                  </th>
                  <th
                    style="
                      text-align: center;
                      font-weight: 700;
                      width: 4rem;
                      border-left: 0.5px solid black;
                      border-top: 0.5px solid black;
                      border-bottom: 0.5px solid black;
                    "
                  >
                    SL khách giao
                  </th>
                  <th
                    style="
                      text-align: center;
                      font-weight: 700;
                      width: 4rem;
                      border-left: 0.5px solid black;
                      border-top: 0.5px solid black;
                      border-bottom: 0.5px solid black;
                    "
                  >
                    SL thực nhận
                  </th>
                  <th
                    style="
                      text-align: center;
                      font-weight: 700;
                      width: 3rem;
                      border-left: 0.5px solid black;
                      border-top: 0.5px solid black;
                      border-bottom: 0.5px solid black;
                    "
                  >
                    SL SP đổi mới
                  </th>
                  <th
                    style="
                      text-align: center;
                      font-weight: 700;
                      width: 3.5rem;
                      border-left: 0.5px solid black;
                      border-top: 0.5px solid black;
                      border-bottom: 0.5px solid black;
                    "
                  >
                    SL SP sửa chữa
                  </th>
                  <th
                    style="
                      text-align: center;
                      font-weight: 700;
                      width: 4rem;
                      border-left: 0.5px solid black;
                      border-top: 0.5px solid black;
                      border-bottom: 0.5px solid black;
                    "
                  >
                    SL SP không được bảo hành
                  </th>
                  <th
                    style="
                      text-align: center;
                      font-weight: 700;
                      width: 10rem;
                      border-left: 0.5px solid black;
                      border-top: 0.5px solid black;
                      border-bottom: 0.5px solid black;
                    "
                  >
                    Lý do không bảo hành
                  </th>
                  <th style="text-align: center; font-weight: 700; width: 10rem; border: 0.5px solid black">Lý do sửa chữa</th>
                </tr>
              </thead>
              <tbody class="body-table" *ngFor="let data of resultChiTietSanPhamTiepNhans; let i = index">
                <td
                  style="
                    font-weight: 650;
                    height: 36px;
                    border-left: 0.5px solid black;
                    border-bottom: 0.5px solid black;
                    text-align: center;
                  "
                >
                  {{ i + 1 }}
                </td>
                <td style="font-weight: 650; height: 36px; border-left: 0.5px solid black; border-bottom: 0.5px solid black">
                  {{ data.tenSanPham }}
                </td>
                <td
                  style="
                    font-weight: 650;
                    height: 36px;
                    border-left: 0.5px solid black;
                    border-bottom: 0.5px solid black;
                    text-align: center;
                  "
                >
                  {{ data.donVi }}
                </td>
                <td
                  style="
                    font-weight: 650;
                    height: 36px;
                    border-left: 0.5px solid black;
                    border-bottom: 0.5px solid black;
                    text-align: center;
                  "
                >
                  {{ data.slKhachGiao }}
                </td>
                <td
                  style="
                    font-weight: 650;
                    height: 36px;
                    border-left: 0.5px solid black;
                    border-bottom: 0.5px solid black;
                    text-align: center;
                  "
                >
                  {{ data.slTiepNhan }}
                </td>
                <td
                  style="
                    font-weight: 650;
                    height: 36px;
                    border-left: 0.5px solid black;
                    border-bottom: 0.5px solid black;
                    text-align: center;
                  "
                >
                  {{ data.slDoiMoi }}
                </td>
                <td
                  style="
                    font-weight: 650;
                    height: 36px;
                    border-left: 0.5px solid black;
                    border-bottom: 0.5px solid black;
                    text-align: center;
                  "
                >
                  {{ data.slSuaChua }}
                </td>
                <td
                  style="
                    font-weight: 650;
                    height: 36px;
                    border-left: 0.5px solid black;
                    border-bottom: 0.5px solid black;
                    text-align: center;
                  "
                >
                  {{ data.slKhongBaoHanh }}
                </td>
                <td style="font-weight: 650; height: 36px; border-left: 0.5px solid black; border-bottom: 0.5px solid black"></td>
                <td
                  style="
                    font-weight: 650;
                    height: 36px;
                    border-left: 0.5px solid black;
                    border-bottom: 0.5px solid black;
                    border-right: 0.5px solid black;
                  "
                ></td>
              </tbody>
            </table>
          </div>
          <div class="notes">
            <p>
              Biên bản được lập thành 03 liên (hoặc 4 liên): liên 1 lưu Tổ bảo hành sản phẩm, liên 2 giao khách hàng, liên 3 giao P. Kh,
              liên 4 giao P. BH1 (Với trường hợp khách hàng là C1, 2 Miền Bắc). Đối với chi nhánh (2 liên): liên 1 lưu chi nhánh, liên 2
              giao khách hàng
            </p>
            <p><strong>Lưu ý: Khi khách hàng lấy sản phẩm đổi, phải giao liên 2 cho thủ kho công ty</strong></p>
          </div>
          <footer>
            <div class="row" style="margin-left: -4rem; display: flex; justify-content: space-around">
              <div class="col" style="text-align: center"><strong>ĐẠI DIỆN KHÁCH HÀNG</strong></div>
              <div class="col" style="text-align: center"><strong>BẢO VỆ</strong></div>
              <div class="col" style="text-align: center">
                <strong>TỔ BẢO HÀNH SẢN PHẨM</strong><br />
                <a [href]="selectedValue" style="font-size: 18px; display: block; margin-top: 6rem; text-decoration: none; color: black">{{
                  selectedValue
                }}</a>
              </div>
            </div>
          </footer>
          <br />
          <br />

          <!-- <header>
            <div class="row">
              <div class="col-6" align="left" style="height: 0px">
                <img src="../../../../content/images/logoRD.png" alt="CÔNG TY CP BÓNG ĐÈN PHÍCH NƯỚC RẠNG ĐÔNG"
                  width="150" style="margin-top: -30px; margin-left: 30px" />
              </div>
              <div class="col-6" align="right">RĐ.QID05.BM01 Ban hành lần 1</div>
            </div>
          </header>
          <div align="center">
            <h3 style="margin-top: -20px">BIÊN BẢN GIAO NHẬN SẢN PHẨM ĐỔI</h3>
            <p style="text-align: center">Liên 4: Phòng BH1</p>
          </div>
          <div align="right" style="margin-right: 80px; font-size: 14px; margin-top: -30px">Số: {{ maBienBan }}</div>
          <br />
          <div style="display: flex; justify-content: space-between; margin-bottom: 5px">
            <div>
              <p>
                Ngày {{ maBienBan.substr(2, 2) }} tháng {{ maBienBan.substr(4, 2) }} năm 20{{ maBienBan.substr(6, 2) }}
                Công ty CP Bóng đèn Phích nước Rạng Đông nhận sản phẩm đổi của
              </p>
              <p>Ông (Bà): {{ donBaoHanh.khachHang.tenKhachHang }}</p>
              <p>Địa chỉ: {{ donBaoHanh.khachHang.diaChi }}</p>
              <div>Kèm giấy đề nghị đổi sản phẩm (nếu có) ngày ... tháng ... năm 20...</div>
            </div>
            <div>
              <div align="right" style="margin-right: 92px">
                <qrcode [qrdata]="donBaoHanh.maTiepNhan" [width]="10" [errorCorrectionLevel]="'M'"
                  [elementType]="'img'"></qrcode>
              </div>
              <br />
              <div align="right" style="margin-right: 94px; font-size: 14px; margin-top: -30px">{{ donBaoHanh.maTiepNhan
                }}</div>
            </div>
          </div>
          <div>
            <table id="table" class="table-TN" style="width: 100%; border-spacing: 0px">
              <thead>
                <tr>
                  <th style="
                      text-align: center;
                      font-weight: 700;
                      width: 1rem;
                      border-left: 0.5px solid black;
                      border-top: 0.5px solid black;
                      border-bottom: 0.5px solid black;
                    ">
                    STT
                  </th>
                  <th style="
                      text-align: center;
                      font-weight: 700;
                      width: 30rem;
                      border-left: 0.5px solid black;
                      border-top: 0.5px solid black;
                      border-bottom: 0.5px solid black;
                    ">
                    Tên sản phẩm
                  </th>
                  <th style="
                      text-align: center;
                      font-weight: 700;
                      width: 3rem;
                      border-left: 0.5px solid black;
                      border-top: 0.5px solid black;
                      border-bottom: 0.5px solid black;
                    ">
                    Đ.vị tính
                  </th>
                  <th style="
                      text-align: center;
                      font-weight: 700;
                      width: 4rem;
                      border-left: 0.5px solid black;
                      border-top: 0.5px solid black;
                      border-bottom: 0.5px solid black;
                    ">
                    SL khách giao
                  </th>
                  <th style="
                      text-align: center;
                      font-weight: 700;
                      width: 4rem;
                      border-left: 0.5px solid black;
                      border-top: 0.5px solid black;
                      border-bottom: 0.5px solid black;
                    ">
                    SL thực nhận
                  </th>
                  <th style="
                      text-align: center;
                      font-weight: 700;
                      width: 3rem;
                      border-left: 0.5px solid black;
                      border-top: 0.5px solid black;
                      border-bottom: 0.5px solid black;
                    ">
                    SL SP đổi mới
                  </th>
                  <th style="
                      text-align: center;
                      font-weight: 700;
                      width: 3.5rem;
                      border-left: 0.5px solid black;
                      border-top: 0.5px solid black;
                      border-bottom: 0.5px solid black;
                    ">
                    SL SP sửa chữa
                  </th>
                  <th style="
                      text-align: center;
                      font-weight: 700;
                      width: 4rem;
                      border-left: 0.5px solid black;
                      border-top: 0.5px solid black;
                      border-bottom: 0.5px solid black;
                    ">
                    SL SP không được bảo hành
                  </th>
                  <th style="
                      text-align: center;
                      font-weight: 700;
                      width: 10rem;
                      border-left: 0.5px solid black;
                      border-top: 0.5px solid black;
                      border-bottom: 0.5px solid black;
                    ">
                    Lý do không bảo hành
                  </th>
                  <th style="text-align: center; font-weight: 700; width: 10rem; border: 0.5px solid black">Lý do sửa
                    chữa</th>
                </tr>
              </thead>
              <tbody class="body-table" *ngFor="let data of resultChiTietSanPhamTiepNhans; let i = index">
                <td
                  style="height: 36px; border-left: 0.5px solid black; border-bottom: 0.5px solid black; text-align: center">
                  {{ i + 1 }}
                </td>
                <td
                  style="font-weight: 650; height: 36px; border-left: 0.5px solid black; border-bottom: 0.5px solid black">
                  {{ data.tenSanPham }}
                </td>
                <td style="
                    font-weight: 650;
                    height: 36px;
                    border-left: 0.5px solid black;
                    border-bottom: 0.5px solid black;
                    text-align: center;
                  ">
                  {{ data.donVi }}
                </td>
                <td style="
                    font-weight: 650;
                    height: 36px;
                    border-left: 0.5px solid black;
                    border-bottom: 0.5px solid black;
                    text-align: center;
                  ">
                  {{ data.slKhachGiao }}
                </td>
                <td style="
                    font-weight: 650;
                    height: 36px;
                    border-left: 0.5px solid black;
                    border-bottom: 0.5px solid black;
                    text-align: center;
                  ">
                  {{ data.slTiepNhan }}
                </td>
                <td style="
                    font-weight: 650;
                    height: 36px;
                    border-left: 0.5px solid black;
                    border-bottom: 0.5px solid black;
                    text-align: center;
                  ">
                  {{ data.slDoiMoi }}
                </td>
                <td style="
                    font-weight: 650;
                    height: 36px;
                    border-left: 0.5px solid black;
                    border-bottom: 0.5px solid black;
                    text-align: center;
                  ">
                  {{ data.slSuaChua }}
                </td>
                <td style="
                    font-weight: 650;
                    height: 36px;
                    border-left: 0.5px solid black;
                    border-bottom: 0.5px solid black;
                    text-align: center;
                  ">
                  {{ data.slKhongBaoHanh }}
                </td>
                <td
                  style="font-weight: 650; height: 36px; border-left: 0.5px solid black; border-bottom: 0.5px solid black">
                </td>
                <td style="
                    font-weight: 650;
                    height: 36px;
                    border-left: 0.5px solid black;
                    border-bottom: 0.5px solid black;
                    border-right: 0.5px solid black;
                  "></td>
              </tbody>
            </table>
          </div>
          <div class="notes">
            <p>
              Biên bản được lập thành 03 liên (hoặc 4 liên): liên 1 lưu Tổ bảo hành sản phẩm, liên 2 giao khách hàng,
              liên 3 giao P. Kh,
              liên 4 giao P. BH1 (Với trường hợp khách hàng là C1, 2 Miền Bắc). Đối với chi nhánh (2 liên): liên 1 lưu
              chi nhánh, liên 2
              giao khách hàng
            </p>
            <p><strong>Lưu ý: Khi khách hàng lấy sản phẩm đổi, phải giao liên 2 cho thủ kho công ty</strong></p>
          </div>
          <footer>
            <div class="row" style="margin-left: -4rem; display: flex; justify-content: space-around">
              <div class="col" style="text-align: center"><strong>ĐẠI DIỆN KHÁCH HÀNG</strong></div>
              <div class="col" style="text-align: center"><strong>BẢO VỆ</strong></div>
              <div class="col" style="text-align: center">
                <strong>TỔ BẢO HÀNH SẢN PHẨM</strong><br />
                <a [href]="selectedValue"
                  style="font-size: 18px; display: block; margin-top: 6rem; text-decoration: none; color: black">{{
                  selectedValue
                  }}</a>
              </div>
            </div>
          </footer> -->
        </div>
      </div>
    </div>
  </div>
</div>
